var l=(t,s,o)=>new Promise((n,a)=>{var c=e=>{try{i(o.next(e))}catch(r){a(r)}},u=e=>{try{i(o.throw(e))}catch(r){a(r)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(c,u);i((o=o.apply(t,s)).next())});function m(t){return new Promise((s,o)=>{const n=new FileReader;n.readAsDataURL(t),n.onload=()=>s(n.result),n.onerror=a=>o(a)})}function w(t,s,o,n){return l(this,null,function*(){const a="https://script.google.com/macros/s/AKfycbwbDzZlXnWSH2h98YPHRvWdzHUsVgVE1Tc0ZHiTA0TzJJUb_ydorHg62-nCPOJERR_9jA/exec",c=yield m(t),u=c.includes(",")?c.split(",")[1]:c,i={action:"uploadDocument",file:{name:t.name,content:u,mimeType:t.type||"application/octet-stream"},project:s,orderId:o,documentName:n||t.name},e=yield fetch(a,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(i)});if(!e.ok){if(e.status===401||e.status===403)throw new Error("Authentication required. Please sign in with your Google account.");const d=yield e.text();throw new Error(`HTTP error! status: ${e.status}, message: ${d}`)}const r=yield e.json();if(r.success&&r.filePath)return r.filePath;throw new Error(r.error||"Failed to upload file")})}export{m as fileToBase64,w as uploadDocumentToDrive};
